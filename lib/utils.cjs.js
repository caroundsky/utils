"use strict";function appendScript(e){var t=e.doc,n=void 0===t?document:t,r=e.url,o=e.attrs;try{return new Promise(function(e){var t=document.createElement("script");t.src=r,o&&Object.keys(o).forEach(function(e){t.setAttribute(e,o[e])}),t.addEventListener("load",function(){e(this)}),n.body.appendChild(t)})}catch(e){console.log(e)}}function arrToTree(e,t){for(var t=void 0===t?{}:t,n=t.id,r=void 0===n?"id":n,n=t.pId,o=void 0===n?"pId":n,n=t.child,a=void 0===n?"child":n,i=[],s=e.reduce(function(e,t){return e[t[r]]=t,e},{}),c=0,u=Object.values(s);c<u.length;c++){var l,f=u[c];f[o]?((l=s[f[o]])[a]=l[a]||[],l[a].push(f)):i.push(f)}return i}Object.defineProperty(exports,"__esModule",{value:!0});var defaults=defaults||{};function deepMerge(e,t,n){var r,o={};if(Array.isArray(e))return e.concat(t);for(r in e)o[a=n?r.toLowerCase():r]=e[r];for(r in t){var a=n?r.toLowerCase():r,i=t[r];o[a]=a in o&&"object"==typeof i?deepMerge(o[a],i,!1):i}return o}function redaxios(e,t,n,r){"string"!=typeof e&&(e=(t=e).url);var o={config:t},a=deepMerge(defaults,t),t={},i=r||a.data,r=((a.transformRequest||[]).map(function(e){i=e(i,a.headers)||i}),i&&"object"==typeof i&&"function"!=typeof i.append&&(i=JSON.stringify(i),t["Content-Type"]="application/json;charset=UTF-8"),"undefined"!=typeof document&&document.cookie.match(RegExp("(^|; )"+a.xsrfCookieName+"=([^;]*)")));return r&&(t[a.xsrfHeaderName]=decodeURIComponent(r[2])),a.auth&&(t.authorization=a.auth),a.baseURL&&(e=e.replace(/^(?!.*\/\/)\/?(.*)$/,a.baseURL+"/$1")),a.params&&(r=~e.indexOf("?")?"&":"?",e+=r+(a.paramsSerializer?a.paramsSerializer(a.params):new URLSearchParams(a.params))),(a.fetch||fetch)(e,{method:n||a.method,body:i,headers:deepMerge(a.headers,t,!1),credentials:a.withCredentials?"include":"same-origin"}).then(function(e){for(var t in e)"function"!=typeof e[t]&&(o[t]=e[t]);var n=a.validateStatus?a.validateStatus(e.status):e.ok;return"stream"==a.responseType?(o.data=e.body,o):e[a.responseType||"text"]().then(function(e){o.data=e,o.data=JSON.parse(e)}).catch(Object).then(function(){return n?o:(o.msg=o.status+" "+o.statusText,Promise.reject(o))})})}(redaxios.request=redaxios).get=function(e,t){return redaxios(e,t,"get")},redaxios.delete=function(e,t){return redaxios(e,t,"delete")},redaxios.head=function(e,t){return redaxios(e,t,"head")},redaxios.options=function(e,t){return redaxios(e,t,"options")},redaxios.post=function(e,t,n){return redaxios(e,n,"post",t)},redaxios.put=function(e,t,n){return redaxios(e,n,"put",t)},redaxios.patch=function(e,t,n){return redaxios(e,n,"patch",t)},redaxios.all=Promise.all.bind(Promise),redaxios.spread=function(t){return function(e){return t.apply(this,e)}},redaxios.CancelToken="function"==typeof AbortController?AbortController:Object,redaxios.defaults=defaults;var Redaxios=function(e){return redaxios(e)},setDefalut=function(t,n){return Object.keys(n).forEach(function(e){t.hasOwnProperty(e)||(t[e]=n[e])}),t},isType=function(t){return function(e){return Object.prototype.toString.call(e)==="[object ".concat(t,"]")}},Axios=Redaxios,EMPTY_EUM=[],isArray=isType("Array"),isObject=isType("Object");function delEmpty(e,t){EMPTY_EUM=["",void 0,null];e=JSON.parse(JSON.stringify(e));return t&&(isArray(t)?EMPTY_EUM.push.apply(EMPTY_EUM,t):EMPTY_EUM.push(t)),isEmpty(e)}function isEmpty(n){return isArray(n)?n.reduce(function(e,t,n){return isArray(t)||isObject(t)?e.push(isEmpty(t)):EMPTY_EUM.includes(t)||e.push(t),e},[]):isObject(n)?(Object.keys(n).forEach(function(e){var t=n[e];isArray(t)&&(n[e]=isEmpty(t)),EMPTY_EUM.includes(t)&&delete n[e]}),n):void 0}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function __rest(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}function __awaiter(e,i,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{a(c.next(e))}catch(e){t(e)}}function o(e){try{a(c.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}a((c=c.apply(e,i||[])).next())})}function __generator(r,o){var a,i,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(r,c)}catch(e){t=[6,e],i=0}finally{a=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}var DEFAULT_VALUE$1={suffix:"xlsx",errMatch:'"msg'};function downLoadFile(e,t){var n=this,t=setDefalut(t,DEFAULT_VALUE$1),l=t.fileName,f=t.suffix,p=t.errMatch,d=t.transformResponse,r=__rest(t,["fileName","suffix","errMatch","transformResponse"]);return r.headers={Accept:"application/json, text/plain, */*"},new Promise(function(c,u){Axios(__assign({url:e,method:"post",responseType:"blob",withCredentials:!0,validateStatus:function(e){return[200].includes(e)}},r)).then(function(s){return __awaiter(n,void 0,void 0,function(){var t,n,r,o,a,i;return __generator(this,function(e){switch(e.label){case 0:if("function"==typeof d&&(s=d(s)),r=s.headers,t=s.data,200!==s.status)return[2,u({errMsg:s})];n="",l?n="".concat(l,".").concat(f):(r=r.get("content-disposition"))&&-1!==r.indexOf("attchement")&&null!=(r=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(r))&&r[1]&&(n=decodeURI(r[1].replace(/['"]/g,""))),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.text()];case 2:return r=e.sent(),-1<JSON.stringify(r).indexOf(p)?[2,u({errMsg:r})]:[3,4];case 3:return i=e.sent(),console.log(i),alert("您的浏览器版本太低，可能会导致导出失败，建议升级您的浏览器版本"),[3,4];case 4:return o=window.URL||window.webkitURL,a=o.createObjectURL(t),n?void 0===(i=document.createElement("a")).download?window.location.href=a:(i.href=a,i.download=n,document.body.appendChild(i),i.click(),i.remove()):window.open(a),setTimeout(function(){return o.revokeObjectURL(a)},100),c(),[2]}})})}).catch(function(e){return u({errMsg:e})})})}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var FileSaver_min=createCommonjsModule(function(e,t){function c(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){o(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&t.status<=299}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var u,l,o;u="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof commonjsGlobal&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,l=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=u.saveAs||("object"!=typeof window||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,n){var r=u.URL||u.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?s(o):i(o.href)?c(e,t,n):s(o,o.target="_blank")):(o.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){s(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){var r,o,a;t=t||e.name||"download","string"!=typeof e?navigator.msSaveOrOpenBlob((o=e,void 0===(a=n)?a={autoBom:!1}:"object"!=typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\ufeff",o],{type:o.type}):o),t):i(e)?c(e,t,n):((r=document.createElement("a")).href=e,r.target="_blank",setTimeout(function(){s(r)}))}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return c(e,t,n);var o,a,i,t="application/octet-stream"===e.type,n=/constructor/i.test(u.HTMLElement)||u.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);(s||t&&n||l)&&"undefined"!=typeof FileReader?((o=new FileReader).onloadend=function(){var e=o.result,e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;");r?r.location.href=e:location=e,r=null},o.readAsDataURL(e)):(a=u.URL||u.webkitURL,i=a.createObjectURL(e),r?r.location=i:location.href=i,r=null,setTimeout(function(){a.revokeObjectURL(i)},4e4))}),u.saveAs=o.saveAs=o,e.exports=o}),DEFAULT_VALUE={fileName:"".concat((new Date).getTime()),suffix:"zip"};function getFile(a){return new Promise(function(r,o){Axios({url:a,method:"get",responseType:"blob"}).then(function(e){var t=e.status,n=e.msg;/^[4,5]/.test(t.toString())&&o({msg:n,url:a}),r(e)}).catch(function(e){e={msg:e.msg||e.message,url:a};o(e)})})}function filesZip(f){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,a,i,s,c,u,l;return __generator(this,function(e){switch(e.label){case 0:return o=setDefalut(f,DEFAULT_VALUE),t=o.prefix,n=o.fileName,r=o.suffix,o=o.fileList,(a=window.JSZip)?[3,2]:[4,appendScript({url:"//cdnjs.cloudflare.com/ajax/libs/jszip/3.9.1/jszip.min.js"})];case 1:e.sent(),a=window.JSZip,e.label=2;case 2:for(a=new a,i=[],s=function(r){var e=getFile(t?"".concat(t).concat(r.fileUrl):r.fileUrl).then(function(e){var t=e.headers,e=e.data,n="";r.name?n="".concat((new Date).getTime()).concat(r.name):(t=t.get("content-disposition"))&&-1!==t.indexOf("attchement")?null!=(t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(t))&&t[1]&&(n=decodeURI(t[1].replace(/['"]/g,""))):n=(t=r.fileUrl.split("/"))[t.length-1],a.file(n,e,{binary:!0})});i.push(e)},c=0,u=o;c<u.length;c++)l=u[c],s(l);return[2,Promise.all(i).then(function(){a.generateAsync({type:"blob"}).then(function(e){FileSaver_min.saveAs(e,"".concat(n,".").concat(r))})})]}})})}var formatUrl=function(e){for(var t=e.split("?")[1].split("&"),n={},r=0;r<t.length;r++){var o=t[r].split("="),a=o[0],o=o[1];n[a]?(n[a]=Array.isArray(n[a])?n[a]:[n[a]],n[a].push(o)):n[a]=o}return n},getType=function(){var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error","[object Symbol]":"symbol"};return function(e){if(null==e)return e+"";var t=Object.prototype.toString.call(e);return"object"==typeof e||"function"==typeof e?n[t]||"object":typeof e}}();function isEqual(t,n){var e=getType(t),r=getType(n);return e===r&&("array"===e?t.length===n.length&&t.every(function(e,t){return isEqual(e,n[t])}):"object"===r?(e=Object.keys(t)).length===Object.keys(n).length&&e.every(function(e){return isEqual(t[e],n[e])}):t===n)}function unique(e){return e.reduce(function(e,t){return!e.some(function(e){return isEqual(t,e)})&&e.push(t),e},[])}var components={appendScript:appendScript,arrToTree:arrToTree,delEmpty:delEmpty,downloadFile:downLoadFile,filesZip:filesZip,formatUrl:formatUrl,unique:unique};exports.appendScript=appendScript,exports.arrToTree=arrToTree,exports.default=components,exports.delEmpty=delEmpty,exports.downloadFile=downLoadFile,exports.filesZip=filesZip,exports.formatUrl=formatUrl,exports.unique=unique;
