!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Utils={})}(this,function(e){"use strict";function p(e){var t=e.doc,n=void 0===t?document:t,o=e.url,r=e.attrs;try{return new Promise(function(e){var t=document.createElement("script");t.src=o,r&&Object.keys(r).forEach(function(e){t.setAttribute(e,r[e])}),t.addEventListener("load",function(){e(this)}),n.body.appendChild(t)})}catch(e){console.log(e)}}function t(e,t){for(var t=void 0===t?{}:t,n=t.id,o=void 0===n?"id":n,n=t.pId,r=void 0===n?"pId":n,n=t.child,a=void 0===n?"child":n,i=[],c=e.reduce(function(e,t){return e[t[o]]=t,e},{}),u=0,s=Object.values(c);u<s.length;u++){var l,f=s[u];f[r]?((l=c[f[r]])[a]=l[a]||[],l[a].push(f)):i.push(f)}return i}var c={};function u(e,t,n){var o,r={};if(Array.isArray(e))return e.concat(t);for(o in e)r[a=n?o.toLowerCase():o]=e[o];for(o in t){var a=n?o.toLowerCase():o,i=t[o];r[a]=a in r&&"object"==typeof i?u(r[a],i,!1):i}return r}function o(e,t,n,o){"string"!=typeof e&&(e=(t=e).url);var r={config:t},a=u(c,t),t={},i=o||a.data,o=((a.transformRequest||[]).map(function(e){i=e(i,a.headers)||i}),i&&"object"==typeof i&&"function"!=typeof i.append&&(i=JSON.stringify(i),t["Content-Type"]="application/json;charset=UTF-8"),"undefined"!=typeof document&&document.cookie.match(RegExp("(^|; )"+a.xsrfCookieName+"=([^;]*)")));return o&&(t[a.xsrfHeaderName]=decodeURIComponent(o[2])),a.auth&&(t.authorization=a.auth),a.baseURL&&(e=e.replace(/^(?!.*\/\/)\/?(.*)$/,a.baseURL+"/$1")),a.params&&(o=~e.indexOf("?")?"&":"?",e+=o+(a.paramsSerializer?a.paramsSerializer(a.params):new URLSearchParams(a.params))),(a.fetch||fetch)(e,{method:n||a.method,body:i,headers:u(a.headers,t,!1),credentials:a.withCredentials?"include":"same-origin"}).then(function(e){for(var t in e)"function"!=typeof e[t]&&(r[t]=e[t]);var n=a.validateStatus?a.validateStatus(e.status):e.ok;return"stream"==a.responseType?(r.data=e.body,r):e[a.responseType||"text"]().then(function(e){r.data=e,r.data=JSON.parse(e)}).catch(Object).then(function(){return n?r:(r.msg=r.status+" "+r.statusText,Promise.reject(r))})})}(o.request=o).get=function(e,t){return o(e,t,"get")},o.delete=function(e,t){return o(e,t,"delete")},o.head=function(e,t){return o(e,t,"head")},o.options=function(e,t){return o(e,t,"options")},o.post=function(e,t,n){return o(e,n,"post",t)},o.put=function(e,t,n){return o(e,n,"put",t)},o.patch=function(e,t,n){return o(e,n,"patch",t)},o.all=Promise.all.bind(Promise),o.spread=function(t){return function(e){return t.apply(this,e)}},o.CancelToken="function"==typeof AbortController?AbortController:Object,o.defaults=c;function h(t,n){return Object.keys(n).forEach(function(e){t.hasOwnProperty(e)||(t[e]=n[e])}),t}function n(t){return function(e){return Object.prototype.toString.call(e)==="[object ".concat(t,"]")}}var b=function(e){return o(e)},r=[],a=n("Array"),i=n("Object");function s(e,t){r=["",void 0,null];e=JSON.parse(JSON.stringify(e));return t&&(a(t)?r.push.apply(r,t):r.push(t)),function o(n){if(a(n))return n.reduce(function(e,t,n){return a(t)||i(t)?e.push(o(t)):r.includes(t)||e.push(t),e},[]);if(i(n))return Object.keys(n).forEach(function(e){var t=n[e];a(t)&&(n[e]=o(t)),r.includes(t)&&delete n[e]}),n}(e)}var y=function(){return(y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function m(e,i,c,u){return new(c=c||Promise)(function(n,t){function o(e){try{a(u.next(e))}catch(e){t(e)}}function r(e){try{a(u.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(o,r)}a((u=u.apply(e,i||[])).next())})}function v(o,r){var a,i,c,u={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,i&&(c=2&t[0]?i.return:t[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,t[1])).done)return c;switch(i=0,(t=c?[2&t[0],c.value]:t)[0]){case 0:case 1:c=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(c=0<(c=u.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){u.label=t[1];break}if(6===t[0]&&u.label<c[1]){u.label=c[1],c=t;break}if(c&&u.label<c[2]){u.label=c[2],u.ops.push(t);break}c[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(o,u)}catch(e){t=[6,e],i=0}finally{a=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}var g={suffix:"xlsx",errMatch:'"msg'};function l(e,t){var n=this,t=h(t,g),l=t.fileName,f=t.suffix,p=t.errMatch,d=t.transformResponse,o=function(e,t){var n={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}(t,["fileName","suffix","errMatch","transformResponse"]);return o.headers={Accept:"application/json, text/plain, */*"},new Promise(function(u,s){b(y({url:e,method:"post",responseType:"blob",withCredentials:!0,validateStatus:function(e){return[200].includes(e)}},o)).then(function(c){return m(n,void 0,void 0,function(){var t,n,o,r,a,i;return v(this,function(e){switch(e.label){case 0:if("function"==typeof d&&(c=d(c)),o=c.headers,t=c.data,200!==c.status)return[2,s({errMsg:c})];n="",l?n="".concat(l,".").concat(f):(o=o.get("content-disposition"))&&-1!==o.indexOf("attchement")&&null!=(o=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(o))&&o[1]&&(n=decodeURI(o[1].replace(/['"]/g,""))),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.text()];case 2:return o=e.sent(),-1<JSON.stringify(o).indexOf(p)?[2,s({errMsg:o})]:[3,4];case 3:return i=e.sent(),console.log(i),alert("您的浏览器版本太低，可能会导致导出失败，建议升级您的浏览器版本"),[3,4];case 4:return r=window.URL||window.webkitURL,a=r.createObjectURL(t),n?void 0===(i=document.createElement("a")).download?window.location.href=a:(i.href=a,i.download=n,document.body.appendChild(i),i.click(),i.remove()):window.open(a),setTimeout(function(){return r.revokeObjectURL(a)},100),u(),[2]}})})}).catch(function(e){return s({errMsg:e})})})}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(e){function u(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){r(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&t.status<=299}function c(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var s,l,r;s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof f&&f.global===f?f:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,n){var o=s.URL||s.webkitURL,r=document.createElement("a");t=t||e.name||"download",r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin===location.origin?c(r):i(r.href)?u(e,t,n):c(r,r.target="_blank")):(r.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(r.href)},4e4),setTimeout(function(){c(r)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){var o,r,a;t=t||e.name||"download","string"!=typeof e?navigator.msSaveOrOpenBlob((r=e,void 0===(a=n)?a={autoBom:!1}:"object"!=typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\ufeff",r],{type:r.type}):r),t):i(e)?u(e,t,n):((o=document.createElement("a")).href=e,o.target="_blank",setTimeout(function(){c(o)}))}:function(e,t,n,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return u(e,t,n);var r,a,i,t="application/octet-stream"===e.type,n=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);(c||t&&n||l)&&"undefined"!=typeof FileReader?((r=new FileReader).onloadend=function(){var e=r.result,e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;");o?o.location.href=e:location=e,o=null},r.readAsDataURL(e)):(a=s.URL||s.webkitURL,i=a.createObjectURL(e),o?o.location=i:location.href=i,o=null,setTimeout(function(){a.revokeObjectURL(i)},4e4))}),s.saveAs=r.saveAs=r,e.exports=r})(R={exports:{}});var d=R.exports,w={fileName:"".concat((new Date).getTime()),suffix:"zip"};function j(f){return m(this,void 0,void 0,function(){var t,n,o,r,i,c,a,u,s,l;return v(this,function(e){switch(e.label){case 0:return r=h(f,w),t=r.prefix,n=r.fileName,o=r.suffix,r=r.fileList,(i=window.JSZip)?[3,2]:[4,p({url:"//cdnjs.cloudflare.com/ajax/libs/jszip/3.9.1/jszip.min.js"})];case 1:e.sent(),i=window.JSZip,e.label=2;case 2:for(i=new i,c=[],a=function(o){var a,e=t?"".concat(t).concat(o.fileUrl):o.fileUrl,e=(a=e,new Promise(function(o,r){b({url:a,method:"get",responseType:"blob"}).then(function(e){var t=e.status,n=e.msg;/^[4,5]/.test(t.toString())&&r({msg:n,url:a}),o(e)}).catch(function(e){e={msg:e.msg||e.message,url:a};r(e)})}).then(function(e){var t=e.headers,e=e.data,n="";o.name?n="".concat((new Date).getTime()).concat(o.name):(t=t.get("content-disposition"))&&-1!==t.indexOf("attchement")?null!=(t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(t))&&t[1]&&(n=decodeURI(t[1].replace(/['"]/g,""))):n=(t=o.fileUrl.split("/"))[t.length-1],i.file(n,e,{binary:!0})}));c.push(e)},u=0,s=r;u<s.length;u++)l=s[u],a(l);return[2,Promise.all(c).then(function(){i.generateAsync({type:"blob"}).then(function(e){d.saveAs(e,"".concat(n,".").concat(o))})})]}})})}function O(e){for(var t=e.split("?")[1].split("&"),n={},o=0;o<t.length;o++){var r=t[o].split("="),a=r[0],r=r[1];n[a]?(n[a]=Array.isArray(n[a])?n[a]:[n[a]],n[a].push(r)):n[a]=r}return n}x={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error","[object Symbol]":"symbol"};var x,S=function(e){if(null==e)return e+"";var t=Object.prototype.toString.call(e);return"object"==typeof e||"function"==typeof e?x[t]||"object":typeof e};function T(e){return e.reduce(function(e,t){return!e.some(function(e){return function n(t,o){var e=S(t),r=S(o);return e===r&&("array"===e?t.length===o.length&&t.every(function(e,t){return n(e,o[t])}):"object"===r?(e=Object.keys(t)).length===Object.keys(o).length&&e.every(function(e){return n(t[e],o[e])}):t===o)}(t,e)})&&e.push(t),e},[])}var R={appendScript:p,arrToTree:t,delEmpty:s,downloadFile:l,filesZip:j,formatUrl:O,unique:T};e.appendScript=p,e.arrToTree=t,e.default=R,e.delEmpty=s,e.downloadFile=l,e.filesZip=j,e.formatUrl=O,e.unique=T,Object.defineProperty(e,"__esModule",{value:!0})});
